{"version":3,"file":"vue-render-plugin.min.js","sources":["../src/filters.js","../src/mixin.js","../src/index.js"],"sourcesContent":["import Vue from 'vue';\r\n\r\nVue.filter('kebab', (str) => {\r\n    const replace = s =>  s.toLowerCase().replace(/ /g, '-');\r\n\r\n    return Array.isArray(str) ?  str.map(replace) : replace(str);\r\n});","export default {\r\n    props: ['node', 'editor', 'bindSocket', 'bindControl'],\r\n    methods: {\r\n        inputs() {\r\n            return Array.from(this.node.inputs.values())\r\n        },\r\n        outputs() {\r\n            return Array.from(this.node.outputs.values())\r\n        },\r\n        controls() {\r\n            return Array.from(this.node.controls.values())\r\n        },\r\n        selected() {\r\n            return this.editor.selected.contains(this.node) ? 'selected' : '';\r\n        }\r\n    },\r\n    directives: {\r\n        socket: {\r\n            bind(el, binding, vnode) {\r\n                vnode.context.bindSocket(el, binding.arg, binding.value);\r\n            },\r\n            update(el, binding, vnode) {\r\n                vnode.context.bindSocket(el, binding.arg, binding.value);\r\n            }\r\n        },\r\n        control: {\r\n            bind(el, binding, vnode) {\r\n                if (!binding.value) return;\r\n\r\n                vnode.context.bindControl(el, binding.value);\r\n            }\r\n        }\r\n    }\r\n}","import './filters';\r\nimport Node from './Node.vue';\r\nimport Socket from './Socket.vue';\r\nimport Vue from 'vue';\r\nimport mixin from './mixin';\r\n\r\nfunction createVue(el, vueComponent, vueProps) {\r\n    const app = new Vue({\r\n        render: h => h(vueComponent, { props: vueProps })\r\n    });\r\n\r\n    const nodeEl = document.createElement('div');\r\n\r\n    el.appendChild(nodeEl);\r\n    app.$mount(nodeEl);\r\n    \r\n    return app;\r\n}\r\n\r\nfunction createNode(editor, { el, node, component, bindSocket, bindControl }) {\r\n    const vueComponent = component.component || Node;\r\n    const vueProps = { ...component.props, node, editor, bindSocket, bindControl };\r\n    const app = createVue(el, vueComponent, vueProps);\r\n\r\n    node.vueContext = app.$children[0];\r\n\r\n    return app;\r\n}\r\n\r\nfunction createControl(editor, { el, control }) {\r\n    const vueComponent = control.component;\r\n    const vueProps = { ...control.props, getData: control.getData.bind(control), putData: control.putData.bind(control) };\r\n    const app = createVue(el, vueComponent, vueProps);\r\n\r\n    control.vueContext = app.$children[0];\r\n\r\n    return app;\r\n}\r\n\r\nconst update = (entity) => {\r\n    return new Promise((res) => {\r\n        if (entity.vueContext)\r\n            entity.vueContext.$forceUpdate();\r\n        entity.vueContext.$nextTick(res);\r\n    });\r\n}\r\n\r\nfunction install(editor, params) {\r\n    editor.on('rendernode', ({ el, node, component, bindSocket, bindControl }) => {\r\n        if (component.render && component.render !== 'vue') return;\r\n        node._vue = createNode(editor, { el, node, component, bindSocket, bindControl });\r\n        node.update = async () => await update(node);\r\n    });\r\n\r\n    editor.on('rendercontrol', ({ el, control }) => {\r\n        if (control.render && control.render !== 'vue') return;\r\n        control._vue = createControl(editor, { el, control });\r\n        control.update = async () => await update(control)\r\n    });\r\n\r\n    editor.on('connectioncreated connectionremoved', connection => {\r\n        update(connection.output.node)\r\n        update(connection.input.node)\r\n    });\r\n\r\n    editor.on('nodeselected', () => {\r\n        editor.nodes.map(update);\r\n    });\r\n}\r\n\r\nexport default {\r\n    name: 'vue-render',\r\n    install,\r\n    mixin,\r\n    Node,\r\n    Socket\r\n}\r\n"],"names":["filter","str","replace","s","toLowerCase","Array","isArray","map","props","methods","inputs","from","this","node","values","outputs","controls","selected","editor","contains","directives","socket","bind","el","binding","vnode","context","bindSocket","arg","value","update","control","bindControl","createVue","vueComponent","vueProps","app","Vue","render","h","nodeEl","document","createElement","appendChild","$mount","entity","Promise","res","vueContext","$forceUpdate","$nextTick","name","install","params","on","component","_vue","Node","$children","getData","putData","connection","output","input","nodes","mixin","Socket"],"mappings":";;;;;glOAEIA,OAAO,QAAS,SAACC,OACXC,EAAU,SAAAC,UAAMA,EAAEC,cAAcF,QAAQ,KAAM,aAE7CG,MAAMC,QAAQL,GAAQA,EAAIM,IAAIL,GAAWA,EAAQD,WCL7C,CACXO,MAAO,CAAC,OAAQ,SAAU,aAAc,eACxCC,QAAS,CACLC,yBACWL,MAAMM,KAAKC,KAAKC,KAAKH,OAAOI,WAEvCC,0BACWV,MAAMM,KAAKC,KAAKC,KAAKE,QAAQD,WAExCE,2BACWX,MAAMM,KAAKC,KAAKC,KAAKG,SAASF,WAEzCG,2BACWL,KAAKM,OAAOD,SAASE,SAASP,KAAKC,MAAQ,WAAa,KAGvEO,WAAY,CACRC,OAAQ,CACJC,cAAKC,EAAIC,EAASC,GACdA,EAAMC,QAAQC,WAAWJ,EAAIC,EAAQI,IAAKJ,EAAQK,QAEtDC,gBAAOP,EAAIC,EAASC,GAChBA,EAAMC,QAAQC,WAAWJ,EAAIC,EAAQI,IAAKJ,EAAQK,SAG1DE,QAAS,CACLT,cAAKC,EAAIC,EAASC,GACTD,EAAQK,OAEbJ,EAAMC,QAAQM,YAAYT,EAAIC,EAAQK,okSCvB7CI,EAAUV,EAAIW,EAAcC,OAC3BC,EAAM,IAAIC,EAAI,CAChBC,OAAQ,SAAAC,UAAKA,EAAEL,EAAc,CAAE1B,MAAO2B,OAGpCK,EAASC,SAASC,cAAc,cAEtCnB,EAAGoB,YAAYH,GACfJ,EAAIQ,OAAOJ,GAEJJ,EAuBX,IAAMN,EAAS,SAACe,UACL,IAAIC,QAAQ,SAACC,GACZF,EAAOG,YACPH,EAAOG,WAAWC,eACtBJ,EAAOG,WAAWE,UAAUH,YA2BrB,CACXI,KAAM,aACNC,QAzBJ,SAAiBlC,EAAQmC,GACrBnC,EAAOoC,GAAG,aAAc,gBA7BRpC,IAAUK,EAAIV,EAAM0C,EAAW5B,EAAYK,EAGrDI,EA0BqBb,IAAAA,GAAIV,IAAAA,KAAM0C,IAAAA,UAAW5B,IAAAA,WAAYK,IAAAA,YACpDuB,EAAUjB,QAA+B,QAArBiB,EAAUjB,SAClCzB,EAAK2C,MA/BOtC,EA+BWA,EA/BDK,KA+BS,CAAEA,GAAAA,EAAIV,KAAAA,EAAM0C,UAAAA,EAAW5B,WAAAA,EAAYK,YAAAA,IA/B5CT,GAAIV,IAAAA,KAAM0C,IAAAA,UAAW5B,IAAAA,WAAYK,IAAAA,YAGrDI,EAAMH,EAAUV,EAFDgC,EAAUA,WAAaE,OACtBF,EAAU/C,OAAOK,KAAAA,EAAMK,OAAAA,EAAQS,WAAAA,EAAYK,YAAAA,KAGjEnB,EAAKmC,WAAaZ,EAAIsB,UAAU,GAEzBtB,GAyBHvB,EAAKiB,iCAAS,4GAAkBA,EAAOjB,4FAG3CK,EAAOoC,GAAG,gBAAiB,kBAzBE/B,EAAIQ,EAG3BK,EAsBwBb,IAAAA,GAAIQ,IAAAA,QAC1BA,EAAQO,QAA6B,QAAnBP,EAAQO,SAC9BP,EAAQyB,MA3BiBjC,KA2BY,CAAEA,GAAAA,EAAIQ,QAAAA,IA3BlBR,GAAIQ,IAAAA,QAG3BK,EAAMH,EAAUV,EAFDQ,EAAQwB,eACPxB,EAAQvB,OAAOmD,QAAS5B,EAAQ4B,QAAQrC,KAAKS,GAAU6B,QAAS7B,EAAQ6B,QAAQtC,KAAKS,MAG3GA,EAAQiB,WAAaZ,EAAIsB,UAAU,GAE5BtB,GAqBHL,EAAQD,iCAAS,4GAAkBA,EAAOC,4FAG9Cb,EAAOoC,GAAG,sCAAuC,SAAAO,GAC7C/B,EAAO+B,EAAWC,OAAOjD,MACzBiB,EAAO+B,EAAWE,MAAMlD,QAG5BK,EAAOoC,GAAG,eAAgB,WACtBpC,EAAO8C,MAAMzD,IAAIuB,MAOrBmC,MAAAA,EACAR,KAAAA,EACAS,OAAAA"}